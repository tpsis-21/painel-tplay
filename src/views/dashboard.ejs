<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel TPlay - Gerador de Landing Pages</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        border: "hsl(var(--border))",
                        input: "hsl(var(--input))",
                        ring: "hsl(var(--ring))",
                        background: "hsl(var(--background))",
                        foreground: "hsl(var(--foreground))",
                        primary: {
                            DEFAULT: "hsl(var(--primary))",
                            foreground: "hsl(var(--primary-foreground))",
                        },
                        secondary: {
                            DEFAULT: "hsl(var(--secondary))",
                            foreground: "hsl(var(--secondary-foreground))",
                        },
                        muted: {
                            DEFAULT: "hsl(var(--muted))",
                            foreground: "hsl(var(--muted-foreground))",
                        },
                        accent: {
                            DEFAULT: "hsl(var(--accent))",
                            foreground: "hsl(var(--accent-foreground))",
                        },
                        card: {
                            DEFAULT: "hsl(var(--card))",
                            foreground: "hsl(var(--card-foreground))",
                        },
                    },
                    borderRadius: {
                        lg: "var(--radius)",
                        md: "calc(var(--radius) - 2px)",
                        sm: "calc(var(--radius) - 4px)",
                    },
                }
            }
        }
    </script>
    <style type="text/css">
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            --bg-main: #f8fafc;
            --text-main: #0f172a;
            --card-bg: #ffffff;
            --border-color: #e2e8f0;
            --muted-text: #64748b;
            --primary: #2563eb;
            --primary-hover: #1d4ed8;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --radius: 20px;
        }

        .dark {
            --bg-main: #020617;
            --text-main: #f8fafc;
            --card-bg: #0f172a;
            --border-color: #1e293b;
            --muted-text: #94a3b8;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
        }

        body { 
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg-main);
            color: var(--text-main);
            transition: all 0.3s ease;
        }

        .glass {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
            backdrop-filter: blur(12px);
        }

        .card-hover {
            @apply transition-all duration-500 hover:-translate-y-2;
            box-shadow: var(--shadow);
        }

        .text-muted {
            color: var(--muted-text);
        }

        .theme-toggle {
            @apply p-3 rounded-2xl transition-all border;
            background-color: var(--card-bg);
            border-color: var(--border-color);
            color: var(--text-main);
        }

        .theme-toggle:hover {
            border-color: var(--primary);
            color: var(--primary);
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="min-h-screen pb-20">
    <!-- Navbar Premium -->
    <nav class="sticky top-0 z-40 w-full border-b border-border/40 bg-background/80 backdrop-blur-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex h-16 items-center justify-between">
                <div class="flex items-center gap-2">
                    <div class="w-10 h-10 bg-primary rounded-xl flex items-center justify-center shadow-lg shadow-primary/20">
                        <i class="fas fa-rocket text-primary-foreground text-xl"></i>
                    </div>
                    <span class="text-2xl font-black tracking-tighter">TPlay <span class="text-primary">Admin</span></span>
                </div>
                <div class="flex items-center gap-4">
                    <a href="/" class="p-2.5 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors border border-transparent hover:border-border" title="Ver Loja Pública">
                        <i class="fas fa-external-link-alt"></i>
                    </a>
                    <button onclick="toggleTheme()" class="theme-toggle" aria-label="Alternar Tema">
                        <i class="fas fa-moon dark:hidden"></i>
                        <i class="fas fa-sun hidden dark:block text-yellow-400"></i>
                    </button>
                    <a href="/new" class="flex items-center gap-2 bg-primary text-white px-5 py-2.5 rounded-xl font-bold shadow-lg shadow-primary/25 hover:bg-primary-hover transition-all">
                        <i class="fas fa-plus text-sm"></i>
                        <span>Novo App</span>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-12">
        <!-- Stats Row -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
            <div class="glass p-6 rounded-[2rem] flex items-center gap-5">
                <div class="w-14 h-14 bg-primary/10 text-primary rounded-2xl flex items-center justify-center text-2xl shadow-inner">
                    <i class="fas fa-layer-group"></i>
                </div>
                <div>
                    <p class="text-sm font-bold text-muted uppercase tracking-wider">Total de Apps</p>
                    <h3 class="text-3xl font-black"><%= apps.length %></h3>
                </div>
            </div>
            <div class="glass p-6 rounded-[2rem] flex items-center gap-5">
                <div class="w-14 h-14 bg-emerald-500/10 text-emerald-500 rounded-2xl flex items-center justify-center text-2xl shadow-inner">
                    <i class="fas fa-globe"></i>
                </div>
                <div>
                    <p class="text-sm font-bold text-muted uppercase tracking-wider">Online</p>
                    <h3 class="text-3xl font-black"><%= apps.length %></h3>
                </div>
            </div>
            <div class="glass p-6 rounded-[2rem] flex items-center gap-5">
                <div class="w-14 h-14 bg-amber-500/10 text-amber-500 rounded-2xl flex items-center justify-center text-2xl shadow-inner">
                    <i class="fas fa-bolt"></i>
                </div>
                <div>
                    <p class="text-sm font-bold text-muted uppercase tracking-wider">Status</p>
                    <h3 class="text-xl font-black text-emerald-500 flex items-center gap-2">
                        <span class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></span>
                        Sistema Ativo
                    </h3>
                </div>
            </div>
            <div class="glass p-6 rounded-[2rem] flex items-center gap-5">
                <div class="w-14 h-14 bg-indigo-500/10 text-indigo-500 rounded-2xl flex items-center justify-center text-2xl shadow-inner">
                    <i class="fas fa-code"></i>
                </div>
                <div>
                    <p class="text-sm font-bold text-muted uppercase tracking-wider">Domínio</p>
                    <h3 class="text-sm font-black truncate max-w-[120px]">ajuda.tplay21.in</h3>
                </div>
            </div>
        </div>

        <div class="flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10">
            <div>
                <h2 class="text-3xl font-black tracking-tight">Suas Landing Pages</h2>
                <p class="text-muted mt-1 font-medium">Gerencie e visualize suas páginas geradas.</p>
            </div>
            <div class="relative max-w-sm w-full">
                <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-muted/60"></i>
                <input type="text" id="appSearch" onkeyup="filterApps()" placeholder="Buscar aplicativo..." class="w-full bg-slate-50 dark:bg-slate-900/50 border border-border/50 rounded-2xl py-3.5 pl-12 pr-4 outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all font-medium">
            </div>
        </div>

        <div id="appsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <% if (apps.length === 0) { %>
                <div class="col-span-full py-24 text-center glass rounded-[3rem]">
                    <div class="w-24 h-24 bg-slate-100 dark:bg-slate-800 rounded-[2rem] flex items-center justify-center mx-auto mb-6 text-4xl text-muted/40">
                        <i class="fas fa-folder-plus"></i>
                    </div>
                    <h3 class="text-2xl font-black">Nenhum App Criado</h3>
                    <p class="text-muted mt-2 max-w-sm mx-auto font-medium">Sua biblioteca está vazia. Crie sua primeira landing page agora!</p>
                    <a href="/new" class="mt-8 inline-flex items-center gap-2 bg-primary text-white px-8 py-4 rounded-2xl font-bold shadow-xl shadow-primary/20 hover:scale-105 transition-all">
                        <i class="fas fa-plus"></i>
                        Começar Agora
                    </a>
                </div>
            <% } else { %>
                <% apps.forEach(app => { %>
                    <div class="app-card group glass card-hover rounded-[2.5rem] overflow-hidden flex flex-col" data-name="<%= app.name.toLowerCase() %>">
                        <div class="relative aspect-[16/10] bg-slate-50 dark:bg-slate-900/30 flex items-center justify-center p-10 overflow-hidden">
                            <!-- Background Decorativo -->
                            <div class="absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
                            
                            <img src="<%= app.logo || 'https://via.placeholder.com/150' %>" alt="<%= app.name %>" class="max-h-full max-w-full object-contain rounded-3xl shadow-2xl group-hover:scale-110 transition-transform duration-700 z-10">
                            
                            <!-- Ações Rápidas Overlay -->
                            <div class="absolute inset-0 bg-white/20 dark:bg-black/20 backdrop-blur-[2px] opacity-0 group-hover:opacity-100 transition-all duration-300 flex items-center justify-center gap-4 z-20">
                                <a href="/edit/<%= app.slug %>" title="Editar" class="w-12 h-12 bg-white dark:bg-slate-800 rounded-2xl flex items-center justify-center text-slate-900 dark:text-white hover:bg-primary hover:text-white transition-all shadow-xl hover:-translate-y-1">
                                    <i class="fas fa-pen"></i>
                                </a>
                                <a href="/delete/<%= app.slug %>" title="Excluir" onclick="return confirm('Tem certeza que deseja excluir?')" class="w-12 h-12 bg-white dark:bg-slate-800 rounded-2xl flex items-center justify-center text-red-500 hover:bg-red-500 hover:text-white transition-all shadow-xl hover:-translate-y-1">
                                    <i class="fas fa-trash"></i>
                                </a>
                            </div>
                        </div>
                        
                        <div class="p-8 flex-1 flex flex-col">
                            <div class="mb-6 flex-1">
                                <h3 class="text-2xl font-black truncate group-hover:text-primary transition-colors"><%= app.name %></h3>
                                <div class="flex items-center gap-2 text-sm text-muted mt-2 font-semibold">
                                    <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full"></span>
                                    <span>ajuda.tplay21.in/<%= app.slug %></span>
                                </div>
                            </div>
                            
                            <div class="flex gap-3">
                                <a href="/<%= app.slug %>" target="_blank" class="flex-1 flex items-center justify-center gap-2 py-4 bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-white rounded-2xl font-bold hover:bg-primary hover:text-white transition-all group/btn shadow-sm">
                                    <i class="fas fa-external-link-alt text-sm group-hover/btn:translate-x-1 group-hover/btn:-translate-y-1 transition-transform"></i>
                                    Visualizar Página
                                </a>
                            </div>
                        </div>
                    </div>
                <% }) %>
            <% } %>
        </div>
    </main>

    <script>
        function filterApps() {
            const search = document.getElementById('appSearch').value.toLowerCase();
            const cards = document.querySelectorAll('.app-card');
            cards.forEach(card => {
                const name = card.getAttribute('data-name');
                if (name.includes(search)) {
                    card.style.display = 'flex';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function toggleTheme() {
            const html = document.documentElement;
            const isDark = html.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }

        // Carregar tema salvo ou preferência do sistema
        const savedTheme = localStorage.getItem('theme');
        const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (savedTheme === 'dark' || (!savedTheme && systemPrefersDark)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    </script>
</body>
</html>
